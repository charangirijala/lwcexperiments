<!-- sldsValidatorIgnore -->
<template>
  <table
    aria-multiselectable="true"
    class="slds-table slds-table_bordered slds-table_edit slds-table_fixed-layout slds-table_resizable-cols slds-tree slds-table_tree"
    role="treegrid"
    aria-label="CodeUnits Summary Table"
  >
    <!-- Header -->
    <thead>
      <tr class="slds-line-height_reset">
        <template for:each={columns} for:item="col">
          <th
            aria-sort="none"
            class="slds-has-button-menu slds-is-resizable"
            scope="col"
            key={col.label}
          >
            <a
              class="slds-th__action slds-text-link_reset"
              href="#"
              role="button"
              tabindex="-1"
            >
              <div
                class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate"
              >
                <span class="slds-truncate" title={col.label}>{col.label}</span>
              </div>
            </a>
            <div class="slds-resizable">
              <input
                type="range"
                aria-label="Account Name column width"
                class="slds-resizable__input slds-assistive-text"
                id="cell-resize-handle-56"
                max="1000"
                min="20"
                tabindex="-1"
              />
              <span class="slds-resizable__handle">
                <span class="slds-resizable__divider"></span>
              </span>
            </div>
          </th>
        </template>
      </tr>
    </thead>
    <!-- Body -->
    <tbody>
      <template lwc:if={treeNodes}>
        <template for:each={treeNodes} for:item="node">
          <tr
            key={node.Id}
            aria-expanded={node.isExpanded}
            aria-level={node.level}
            aria-posinset={node.posinset}
            aria-selected="false"
            aria-setsize={node.setsize}
            class={node.classComb}
          >
            <th class="slds-tree__item" data-label="Name" scope="row">
              <template lwc:if={node.hasChild}>
                <button
                  class="slds-button slds-button_icon slds-button_icon-x-small slds-m-right_x-small"
                  tabindex="-1"
                  title="Toggle node"
                  data-id={node.Id}
                >
                  <svg
                    class="slds-button__icon slds-button__icon_small"
                    aria-hidden="true"
                  >
                    <use
                      xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#chevronright"
                    ></use>
                  </svg>
                  <template lwc:if={node.isExpanded}>
                    <span class="slds-assistive-text"
                      >Collapse {node.name}</span
                    >
                  </template>
                  <template lwc:else>
                    <span class="slds-assistive-text">Expand {node.name}</span>
                  </template>
                </button>
              </template>
              <div class="slds-truncate" title={node.name}>
                <a href="#" tabindex="-1">{node.name}</a>
              </div>
            </th>
            <td data-label="Type" role="gridcell">
              <div class="slds-truncate" title={node.type}>{node.type}</div>
            </td>
            <td data-label="hasError" role="gridcell">
              <div class="slds-truncate" title={node.hasError}>
                {node.hasError}
              </div>
            </td>
          </tr>
        </template>
      </template>
    </tbody>
  </table>
</template>
